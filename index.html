
<html>
<head>

  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.95.3/css/materialize.min.css" media="screen,projection" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!--Let browser know website is optimized for mobile-->
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
  <meta content="IE=EmulateIE9" http-equiv="X-UA-Compatible">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#516873">

  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://URLHERE.URLHERE/favicon/apple-touch-icon-152x152.png" />
  <link rel="icon" type="image/png" href="http://URLHERE.URLHERE/favicon/favicon-196x196.png" sizes="196x196" />
  <link rel="icon" type="image/png" href="http://URLHERE.URLHERE/favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="http://URLHERE.URLHERE/favicon/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="http://URLHERE.URLHERE/favicon/favicon-16x16.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="http://URLHERE.URLHERE/favicon/favicon-128.png" sizes="128x128" />
  <meta name="application-name" content="IoT Controlpanel"/>
  <meta name="msapplication-TileColor" content="#C2473B" />
  <meta name="msapplication-TileImage" content="http://URLHERE.URLHERE/favicon/mstile-144x144.png" />
  <meta name="msapplication-square70x70logo" content="http://URLHERE.URLHERE/favicon/mstile-70x70.png" />
  <meta name="msapplication-square150x150logo" content="http://URLHERE.URLHERE/favicon/mstile-150x150.png" />
  <meta name="msapplication-wide310x150logo" content="http://URLHERE.URLHERE/favicon/mstile-310x150.png" />
  <meta name="msapplication-square310x310logo" content="http://URLHERE.URLHERE/favicon/mstile-310x310.png" />

  <title>IoT Controlpanel</title>
  <link href="/res/styles.css" rel="stylesheet" type="text/css">
</head>

<body class="grey lighten-3">

  <header>
    <nav class="teal lighten-2" style="padding-left: 12px;">
      <img src="/res/logo.svg" class="brand-logo right" />
      <ul id="slide-out" class="side-nav">
        <li><a href="#!">Apparaten</a></li>
        <li><a href="#!">Timers</a></li>
        <li><a href="#!">433MHz log</a></li>
      </ul>
      <a href="#" data-activates="slide-out" class="button-collapse show-on-large"><i class="mdi-navigation-menu"></i></a>
    </nav>
  </header>

  <main>
    <div class="row">
      <div class="col l10 offset-l1 m12 offset-m0 offset-m0">

        <div class="row">
          <div class="col l12 m12 s12">
            <div class="card">
              <div class="card-content">
                <i class="small material-icons red-text text-lighten-2" style="vertical-align: middle; font-size: 2.3rem;">bug_report</i>
                <span class="card-title red-text text-darken-1" style="vertical-align: middle; padding-left: 14px;">Socket.IO log</span>
                <div class="row">
                  <div class="col l12">
                    <pre id="logs"></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row" id="cards-area">
        </div>

      </div>
    </div>
  </main>


  <!--Import Socket.IO before jQuery-->
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <!--Import jQuery before materialize.js-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.95.3/js/materialize.min.js" type="text/javascript"></script>
  <script>
    $(function() {

      $('.button-collapse').sideNav({
          menuWidth: 300, // Default is 240
          edge: 'left', // Choose the horizontal origin
          closeOnClick: true // Closes side-nav on <a> clicks, useful for Angular/Meteor
        }
      );

      var socket = io('/clients');
      socket.on('controlstationCount', function(controlstationCount){
        log('Number of controlstations: ' + controlstationCount );
      });
      socket.on('devices', function(devices){
        log('Received ' + devices.length + ' devices' );
        $('#cards-area').html('');
        for(var i in devices)
        {
            addDeviceCard(devices[i]);
        }
      });

    });



    function log(msg) {
      console.log(msg);
      $('#logs').append(msg+'\n');
    }

    const DEVICE_TYPE_LIGHT = 'light-on-off';
    const DEVICE_TYPE_DIMMER = 'light-dimmer';
    function Device(name, type) {
      this.name = name;
      this.type = type;
    }

    function addDeviceCard(device) {
      var card = $("<div/>").attr("class", "col l6 m12").append(getBasicCard('wb_incandescent', device.name));

      var cardContent = $("<div/>").attr("class", "row").html('<div class="col l7 m8 s12">'+ 
                    '<p style="margin-bottom: 16px;">Schakel dit apparaat aan of uit.</p>'+ 
                  '</div>'+ 
                  '<div class="col l5 m4 s12 right">'+ 
                    '<div class="switch center">'+ 
                      '<label>'+ 
                        'Uit'+ 
                        '<input type="checkbox">'+ 
                        '<span class="lever"></span>'+ 
                        'Aan'+ 
                      '</label>'+ 
                    '</div>'+ 
                  '</div>');

      $(card).find('.card-content').append(cardContent);
      $('#cards-area').append(card);
    }

    function getBasicCard(icon, title) {

      return $("<div/>").attr("class", "card").html('<div class="card-content">'+
              '<i class="small material-icons grey-text text-lighten-2" style="vertical-align: middle; font-size: 2.3rem;">'+icon+'</i>'+
              '<span class="card-title orange-text text-darken-2" style="vertical-align: middle; padding-left: 14px;">'+title+'</span>'+
            '</div>');
    }

  </script>

</body>
</html>